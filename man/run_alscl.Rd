% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_alscl.R
\name{run_alscl}
\alias{run_alscl}
\title{Run Age- and Length-Structured Statistical Catch-at-Length Model (ALSCL)}
\usage{
run_alscl(
  data.CatL,
  data.wgt,
  data.mat,
  rec.age,
  nage,
  M,
  sel_L50,
  sel_L95,
  growth_step = 1,
  parameters = NULL,
  parameters.L = NULL,
  parameters.U = NULL,
  map = NULL,
  len_mid = NULL,
  len_border = NULL,
  len_lower = NULL,
  len_upper = NULL,
  output = FALSE,
  train_times = 1,
  ncores = 1,
  silent = FALSE
)
}
\arguments{
\item{data.CatL}{A data frame with length bins in column 1 and survey catch-at-length
in subsequent columns (one per year).}

\item{data.wgt}{A data frame with length bins in column 1 and weight-at-length
in subsequent columns.}

\item{data.mat}{A data frame with length bins in column 1 and maturity-at-length
(proportion 0-1) in subsequent columns.}

\item{rec.age}{Numeric, the recruitment age (e.g. 1).}

\item{nage}{Numeric, the number of age classes.}

\item{M}{Numeric, the natural mortality rate (e.g. 0.2).}

\item{sel_L50}{Numeric, the length at 50 percent survey selectivity.}

\item{sel_L95}{Numeric, the length at 95 percent survey selectivity.}

\item{growth_step}{Numeric, the growth time step. Default is 1 (annual).
Use smaller values for sub-annual data (e.g. 0.25 for quarterly).}

\item{parameters}{A list of custom initial parameter values (default NULL = use defaults).}

\item{parameters.L}{A list of custom lower bounds (default NULL = use defaults).}

\item{parameters.U}{A list of custom upper bounds (default NULL = use defaults).}

\item{map}{A list for TMB map to fix parameters. Default NULL uses:
\code{log_sigma_log_F = factor(NA)} and \code{log_t0 = factor(NA)}.}

\item{len_mid}{Numeric vector, user-specified length bin midpoints (default NULL = auto).}

\item{len_border}{Numeric vector, user-specified length bin borders (default NULL = auto).}

\item{len_lower}{Numeric vector, lower bounds of each length bin (default NULL = auto).
First element can be -Inf. Must be same length as number of bins.}

\item{len_upper}{Numeric vector, upper bounds of each length bin (default NULL = auto).
Last element MUST be finite (not Inf) for the growth transition matrix.}

\item{output}{Logical, if TRUE auto-save all plots and tables. Default FALSE.}

\item{train_times}{Numeric, number of nlminb restarts for refinement. Default 1.}

\item{ncores}{Integer, number of CPU cores. Default 1 (single start).}

\item{silent}{Logical. If TRUE, suppress all progress messages. Default FALSE.
When ncores is greater than 1, runs parallel multi-start optimization with jittered
initial values for robustness against local optima.}
}
\value{
A list containing:
\describe{
\item{report}{TMB report with all estimated quantities (NLA, NL, NA, FL, FA, G, pla,
SSB, B, Rec, CN, CNA, etc.)}
\item{est_std}{Parameter estimates with standard errors from sdreport}
\item{converge}{Convergence message from nlminb}
\item{bound_hit}{Logical, whether any parameter hit its boundary}
\item{year}{Year labels}
\item{len_mid}{Length bin midpoints}
\item{len_label}{Length bin labels from input data}
\item{model_type}{\code{"ALSCL"} identifier for distinguishing from ACL results}
}
}
\description{
Implements the ALSCL model from Zhang and Cadigan (2022) to assess
fish population dynamics from survey catch-at-length data. Unlike the ACL model
which tracks F at the age level, ALSCL simultaneously tracks 3D population
dynamics across time, age, and length (NLA array), with fishing mortality
operating at the length level and a growth transition matrix (G) applied
at each time step.
}
\details{
\strong{Key differences from \code{run_acl()}:}
\itemize{
\item F is modelled at \strong{length} level (\code{dev_log_F} is L x Y),
not at age level (A x Y as in ACL).
\item A \strong{growth transition matrix G} is applied at each time step,
allowing length-dependent processes within cohorts.
\item \strong{F-at-age (FA)} is an emergent property derived from NLA to NA,
not a direct parameter.
\item Additional parameter: \code{log_cv_grow} (CV of growth increment).
\item \code{t0} is log-transformed (\code{log_t0}) rather than raw.
}
}
\references{
Zhang, F., and Cadigan, N. G. (2022). An age- and length-structured
statistical catch-at-length model for hard-to-age fisheries stocks.
\emph{Fish and Fisheries}, 23(5), 1121-1135.
}
