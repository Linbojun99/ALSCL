% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/retro_model.R
\name{retro_model}
\alias{retro_model}
\title{Retrospective Analysis for ACL or ALSCL Models}
\usage{
retro_model(
  nyear = 5,
  data.CatL,
  data.wgt,
  data.mat,
  rec.age,
  nage,
  M,
  sel_L50,
  sel_L95,
  model_type = c("acl", "alscl"),
  growth_step = 1,
  parameters = NULL,
  parameters.L = NULL,
  parameters.U = NULL,
  map = NULL,
  len_mid = NULL,
  len_border = NULL,
  len_lower = NULL,
  len_upper = NULL,
  train_times = 1,
  ncores = 1,
  silent = FALSE,
  plot = FALSE,
  line_size = 1.2,
  point_size = 3,
  point_shape = 21,
  facet_scales = "free",
  facet_col = NULL,
  facet_row = NULL,
  title = NULL,
  xlab = NULL,
  ylab = NULL,
  font_family = NULL,
  title_size = NULL,
  axis_title_size = NULL,
  axis_text_size = NULL,
  strip_text_size = NULL,
  legend_text_size = NULL,
  x_breaks = NULL,
  base_theme = NULL,
  title_hjust = NULL,
  rho_digits = 4,
  rho_position = "top_right",
  rho_size = 3.5
)
}
\arguments{
\item{nyear}{Integer. Number of years to peel (remove) sequentially. Default is 5.}

\item{data.CatL}{The Catch-at-Length data.}

\item{data.wgt}{The weight data.}

\item{data.mat}{The maturity data.}

\item{rec.age}{The recruitment age.}

\item{nage}{The number of age classes.}

\item{M}{The natural mortality rate.}

\item{sel_L50}{The length at 50 percent selectivity.}

\item{sel_L95}{The length at 95 percent selectivity.}

\item{model_type}{Character. Model to use: \code{"acl"} (default) or \code{"alscl"}.}

\item{growth_step}{Numeric. Growth transition time step for ALSCL. Default is 1. Ignored for ACL.}

\item{parameters}{Optional custom starting parameter list.}

\item{parameters.L}{Optional lower bounds for parameters.}

\item{parameters.U}{Optional upper bounds for parameters.}

\item{map}{Optional TMB map argument for fixing parameters.}

\item{len_mid}{Optional numeric vector of length bin midpoints.}

\item{len_border}{Optional numeric vector of length bin borders.}

\item{len_lower}{Optional numeric vector of lower bin boundaries (ALSCL only).}

\item{len_upper}{Optional numeric vector of upper bin boundaries (ALSCL only).}

\item{train_times}{Numeric. Number of optimization restarts. Default is 1.}

\item{ncores}{Integer. Number of CPU cores for parallel peel computation. Default is 1.}

\item{silent}{Logical. If TRUE, suppress all progress messages. Default is FALSE.}

\item{plot}{Logical. If TRUE, include plot in return value. Default is FALSE.}

\item{line_size}{Numeric. Line thickness. Default is 1.2.}

\item{point_size}{Numeric. Point size for endpoints. Default is 3.}

\item{point_shape}{Numeric. Point shape for endpoints. Default is 21.}

\item{facet_scales}{Character. Facet scales argument. Default is "free".}

\item{facet_col}{Integer or NULL. Number of facet columns.}

\item{facet_row}{Integer or NULL. Number of facet rows.}

\item{title}{Character or NULL. Custom plot title.}

\item{xlab}{Character or NULL. Custom x-axis label.}

\item{ylab}{Character or NULL. Custom y-axis label.}

\item{font_family}{Character or NULL. Font family.}

\item{title_size}{Numeric or NULL. Title size in pt.}

\item{axis_title_size}{Numeric or NULL. Axis title size in pt.}

\item{axis_text_size}{Numeric or NULL. Axis tick label size in pt.}

\item{strip_text_size}{Numeric or NULL. Facet label size in pt.}

\item{legend_text_size}{Numeric or NULL. Legend text size in pt.}

\item{x_breaks}{Numeric vector or NULL. Custom x-axis breaks.}

\item{base_theme}{Character or NULL. Base ggplot2 theme name.}

\item{title_hjust}{Numeric or NULL. Title horizontal alignment.}

\item{rho_digits}{Integer. Decimal places for Mohn's rho display. Default is 4.}

\item{rho_position}{Character. Position of rho text. Default is "top_right".}

\item{rho_size}{Numeric. Font size of rho text. Default is 3.5.}
}
\value{
A list containing \code{results}, \code{rho_text}, \code{last_points}, \code{model_type},
and optionally \code{plot}.
}
\description{
Conduct a retrospective analysis by sequentially removing the most recent
years of data and re-fitting the model. Computes Mohn's rho for SSB,
Recruitment, Biomass, and Abundance to quantify retrospective bias.
Supports both ACL and ALSCL model types via the \code{model_type} argument.
}
\examples{
\dontrun{
retro <- retro_model(nyear = 5, data.CatL, data.wgt, data.mat,
                     rec.age = 1, nage = 7, M = 0.8,
                     sel_L50 = 28, sel_L95 = 36, model_type = "acl")
plot_retro(retro)
}
}
